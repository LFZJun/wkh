{"version":3,"sources":["webpack:///webpack/bootstrap 0b1be80ce900b84efd3c","webpack:///./src/modes.js","webpack:///./src/inject.js","webpack:///./src/router.ts"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;;AC7DA;AAAA;AAAA;AACA;AAAA;AAAA;AACA,sB;;;;;;;;;;;;;;ACF0B;AACG;;AAE7B;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,kBAAkB,QAAQ;AAC1B;AACA;AACA;AACA;AACA,iDAAiD,iBAAiB;AAClE;AACA,SAAS;AACT;AACA,iDAAiD,iBAAiB;AAClE;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,KAAK;AACL,CAAC;AACD;AACA,kBAAkB,KAAK;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B;AAC9B,kCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA,gDAAgD;AAChD;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,QAAQ;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,KAAK;AAC1C;AACA,aAAa;AACb,SAAS;AACT,uBAAuB;AACvB;AACA;;;;;;;;;;;AC/GA,cAAc,GAAY;IACtB,IAAI,QAAQ,GAAG,GAAG,CAAC,QAAQ,CAAC;IAC5B,IAAI,CAAC,GAAG,GAAG,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;IACjC,EAAE,CAAC,CAAC,CAAC,GAAG,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC;QACtB,GAAG,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;QACpB,QAAQ,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;IACrB,CAAC;AACL,CAAC;AAED;IAUI,iBAAY,QAAwB,EAAE,MAAiC,EAAE,mBAA+B;QAA5F,wCAAwB;QAAE,oCAAiC;QAAE,6DAA+B;QACpG,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;QACzB,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;QACrB,IAAI,CAAC,mBAAmB,GAAG,mBAAmB,CAAC;IACnD,CAAC;IAED,sBAAI,GAAJ;QACI,IAAI,CAAC,IAAI,CAAC,CAAC;IACf,CAAC;IAED,8BAAY,GAAZ,UAAa,CAAS;QAClB,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;YACxC,MAAM,CAAC,IAAI,CAAC,mBAAmB;QACnC,CAAC;QAED,MAAM,CAAC,IAAI,CAAC,mBAAmB,GAAG,CAAC,CAAC;IACxC,CAAC;IACL,cAAC;AAAD,CAAC;AA3BY,0BAAO;AA6BpB;IAGI,eAAY,QAAwB;QAAxB,wCAAwB;QAChC,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;IAC7B,CAAC;IAED,oBAAI,GAAJ;QAAK,kBAAsB;aAAtB,UAAsB,EAAtB,qBAAsB,EAAtB,IAAsB;YAAtB,6BAAsB;;QACvB,UAAI,CAAC,QAAQ,EAAC,IAAI,WAAI,QAAQ,EAAE;;IACpC,CAAC;IACL,YAAC;AAAD,CAAC;AAVY,sBAAK;AAYlB;IAGI,gBAAY,CAA8B;QAA9B,0BAA8B;QACtC,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC;IACf,CAAC;IAED,uBAAM,GAAN,UAAO,GAAW;QAAE,kBAAsB;aAAtB,UAAsB,EAAtB,qBAAsB,EAAtB,IAAsB;YAAtB,iCAAsB;;QACtC,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,IAAI,CAAC,CAAC,CAAC;YACtB,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,IAAI,KAAK,CAAK,QAAQ,SAAE,CAAC;QAC3C,CAAC;QACD,UAAI,CAAC,CAAC,CAAC,GAAG,CAAC,EAAC,IAAI,WAAI,QAAQ,EAAE;;IAClC,CAAC;IAED,sBAAK,GAAL,UAAM,GAAW,EAAE,GAAY;QAC3B,IAAI,KAAK,GAAG,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;QACxB,EAAE,CAAC,CAAC,KAAK,IAAI,IAAI,CAAC,CAAC,CAAC;YAChB,MAAM;QACV,CAAC;QACD,GAAG,CAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC;QAC9B,IAAI,CAAC,GAAG,CAAC;IACb,CAAC;IAED,oBAAG,GAAH;IAEA,CAAC;IACL,aAAC;AAAD,CAAC;AA1BY,wBAAM","file":"inject.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 0b1be80ce900b84efd3c","export const QUICK = \"quick\";\nexport const SLOW = \"slow\";\nexport const VALUE = \"value\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/modes.js\n// module id = 0\n// module chunks = 0 1","import { Router, Context } from './router.ts';\nimport { QUICK, SLOW, VALUE } from \"./modes\";\n\nconst ELEMENT = \"element$\";\nconst MONKEYS = \"monkeys\";\nconst ITEM = \"item\";\n\nconsole.log(\"注入页面\");\nlet confirmed = false;\n\nlet router = new Router();\n// monkeys\nrouter.handle(`/${MONKEYS}`, ctx => {\n    let element$ = ctx.values[ELEMENT];\n    element$.find(\".panel\").forEach(monkey => {\n        let btns = [];\n        btns.push({\n            button: $('<button style=\"margin:1px;border-color:red;\">最大次数喂养</button>'),\n            mode: SLOW\n        });\n        btns.push({\n            button: $('<button style=\"margin:1px;border-color:red;\">最少次数喂养</button>'),\n            mode: QUICK\n        });\n        console.log(monkey);\n        let elementMonkey = $(monkey);\n        let percent = elementMonkey.find(\".percent\").first().text();\n        let doFeed = function (self, mode) {\n            if (!confirmed) {\n                if (!confirm(\"喂养一只猴子需要向作者转账0.5WKC请确认\")) {\n                    return\n                }\n                confirmed = true\n            }\n            btns.forEach(btn => {\n                btn.button.hide()\n            });\n            chrome.runtime.sendMessage({\n                id: elementMonkey.find(\".id\").first().text().split(' ')[1],\n                limit: Number((percent.split('/')[1] - percent.split('/')[0]).toFixed(2)),\n                mode: mode,\n            }, function (response) {\n                console.log(response);\n            });\n        };\n        btns.forEach(btn => {\n            btn.button.click(function () {\n                doFeed($(this), btn.mode);\n            });\n        });\n        console.log(\"has button\", elementMonkey.has(\"button\").length);\n        if (elementMonkey.find(\"button\").length === 0) {\n            btns.forEach(btn => {\n                elementMonkey.append(btn.button);\n            });\n        }\n    })\n});\n//items\nrouter.handle(`/${ITEM}`, ctx => {\n    let element$ = ctx.values[ELEMENT];\n    let info = $(element$.find(\".info p\").get(1)).text();\n    let priceDiv = element$.find(\".price span\").first();\n    let price = $(element$.find(\".price span\").get(0)).text();\n    if (!info || !priceDiv || !price) {\n        return\n    }\n    let kg = info.split('·')[1].split(' ')[0];\n    let arg1 = info.split('·')[0].split('/')[0];\n    let arg2 = info.split('·')[0].split('/')[1];\n    let arg3 = info.split('·')[0].split('/')[2];\n    let wkc = price.split(' ')[0];\n    let span = $(element$.find(\".price\").find(\".price span\").get(0));\n    if (span.text().indexOf(\";\") !== -1) {\n        wkc = span.text().split(';')[0]\n    }\n    let request = ctx.request;\n    console.log(request.mode, request.min);\n    let mark = arg1 * arg3 * (request.kg === \"true\" ? kg : 1);\n    let showMark = request.mode === VALUE ? mark : mark / wkc;\n    span.text(wkc + \";\" + (showMark).toFixed(5));\n    if (showMark >= request.min) {\n        element$.prop(\"style\", \"background:#F00;\")\n    }\n});\n\nchrome.runtime.onMessage.addListener(\n    function (request, sender, sendResponse) {\n        console.log(\"页面发生变化\");\n        setTimeout(function () {\n            $(\"div\").forEach(element => {\n                let element$ = $(element);\n\n                if (element$.hasClass(MONKEYS)) {\n                    let context = new Context();\n                    context.request = request;\n                    context.sender = sender;\n                    context.sendResponse = sendResponse;\n                    context.values[ELEMENT] = element$;\n                    router.serve(`/${MONKEYS}`, context)\n                }\n                if (element$.hasClass(ITEM)) {\n                    let context = new Context();\n                    context.request = request;\n                    context.sender = sender;\n                    context.sendResponse = sendResponse;\n                    context.values[ELEMENT] = element$;\n                    router.serve(`/${ITEM}`, context);\n                }\n            });\n        }, 1000);\n        sendResponse({})\n    }\n);\n\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/inject.js\n// module id = 2\n// module chunks = 0","export type Handler = ((ctx: Context) => void)\n\nfunction Next(ctx: Context) {\n    let handlers = ctx.handlers;\n    let n = ctx.handlerIndex(-1) + 1;\n    if (n < handlers.length) {\n        ctx.handlerIndex(n);\n        handlers[n](ctx);\n    }\n}\n\nexport class Context {\n    request: any;\n    sender: any;\n    sendResponse: (response: any) => void;\n\n    handlers: Handler[];\n    values: { [key: string]: any };\n    currentHandlerIndex: number;\n\n\n    constructor(handlers: Handler[] = [], values: { [p: string]: any } = {}, currentHandlerIndex: number = 0) {\n        this.handlers = handlers;\n        this.values = values;\n        this.currentHandlerIndex = currentHandlerIndex;\n    }\n\n    next() {\n        Next(this);\n    }\n\n    handlerIndex(n: number): number {\n        if (n < 0 || n > this.handlers.length - 1) {\n            return this.currentHandlerIndex\n        }\n\n        return this.currentHandlerIndex = n;\n    }\n}\n\nexport class Route {\n    handlers: Handler[];\n\n    constructor(handlers: Handler[] = []) {\n        this.handlers = handlers;\n    }\n\n    join(...handlers: Handler[]) {\n        this.handlers.push(...handlers);\n    }\n}\n\nexport class Router {\n    m: { [key: string]: Route };\n\n    constructor(m: { [p: string]: Route } = {}) {\n        this.m = m;\n    }\n\n    handle(key: string, ...handlers: Handler[]) {\n        if (this.m[key] == null) {\n            this.m[key] = new Route([...handlers]);\n        }\n        this.m[key].join(...handlers);\n    }\n\n    serve(key: string, ctx: Context) {\n        let route = this.m[key];\n        if (route == null) {\n            return\n        }\n        ctx.handlers = route.handlers;\n        Next(ctx)\n    }\n\n    run() {\n\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/router.ts"],"sourceRoot":""}